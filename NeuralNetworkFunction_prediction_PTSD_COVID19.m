function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 07-May-2020 17:26:25.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 16xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.272272011;-0.37005737;-0.232881314;-0.298427858;-0.421498194;-0.326070982;-0.113655409;-0.073705196;-0.36406593;-0.21820532;-0.35878303;0.02757931;-0.088311585;-0.223611717;-0.126672276;0.351947562];
x1_step1.gain = [2.21542583975597;1.87258998137544;2.08280473701737;1.9464420868794;2.41498537256642;2.89379751124472;2.78012133125059;2.4173645912499;2.54381608415252;2.92909587984118;2.19125183331359;2.61807015663281;2.40414922690807;2.49528996863302;3.25510213456659;3.99642824021744];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.755263796785474284;1.7293955358959409718;1.5883716164073800048;-1.3960461892314797172;1.2919953578029095276;-1.2151941075586183416;1.0457242793650667334;-1.033489530619831287;-0.84155039294985645171;-0.78277226829073920378;-0.77046338842374884059;-0.74063420511603039742;0.52494404844902164964;0.29251514596546546176;0.35328951291382071354;0.16617134343952749687;-0.076592934311850088824;0.10949676252620987871;0.20084344812262788782;0.41655590331225517131;-0.41402217000724989004;-0.55346558299736625663;0.66985822048286292052;0.7500926544838901755;-0.8431734052067114682;-0.90077077506888969527;1.2326859991217493651;-1.2880139035273083792;1.2988935693192877885;1.4503779517904817897;1.5258473211954792781;-1.6370706817307820735;1.8260149896877448938];
IW1_1 = [-0.16922965456961419628 0.51458653853619606977 -0.63368742898538066299 -0.14220230845818818133 0.16430416837652955797 0.76998800149002744053 0.63962422891718317963 -0.47763481250170874981 0.64227745469216490637 0.17301874073428702427 0.37041019150609943988 -0.13834951020068639305 0.11659354080635378481 0.664879277438792049 0.057144734853954368137 -0.047935087447108448711;-0.23604114609406140479 -0.45632385143901121882 -0.4754001631379196624 -0.58168587365957014068 -0.13988772806619342859 -0.046030576039679069189 -0.42696062031216375221 0.37957166411552673013 0.47993702267455590205 0.11965523012297236971 -0.108933044376558541 -0.056861829117748272089 0.72123333855523852343 0.66992837366866120341 0.017968154905326327864 0.58585653112919888752;-0.26280824242030809135 0.55902511000539267805 -0.66530387210115926599 0.28409289655941249997 0.54647654348139029779 -0.23110457679458989988 0.046681312050663351099 0.4732987340658592057 0.21212667443219851426 -0.59009494629438252744 0.44804502629900916366 0.46085254681833709434 0.30506864499085767362 -0.034870516198587053758 -0.44912962660387428793 -0.52722163812043720821;0.44736380849786383518 0.4044424318563352716 -0.53390925071052908191 -0.54296658101112549311 0.078545439614772727399 -0.076618542430403654975 0.55901087467149546129 -0.12132024151747633489 -0.55918537196464146444 -0.18667381175280253758 -0.89582645146596429075 -0.14156282049667340273 -0.27970724682780889747 -0.29903308527229349734 0.47719776938991637083 0.34781724647595324562;-0.48541513235341487986 -0.31111918873479671444 -0.71580725062673389303 0.14148160348955587939 0.48859265169404492157 -0.60234823973516249396 -0.55371913308739395543 0.26452822942263520822 -0.41416323998464210643 0.6837205070816517738 -0.057327116988394342945 0.10923699175296015806 0.098990216987241752555 -0.63987531648970974452 0.055581254157816964434 -0.47049921749069811838;0.0024499374183698241492 0.68748374333283612803 0.38321304178112913785 -0.20390210771673444867 -0.3947954755005277927 -0.3989351685898747113 -0.86515478916881305427 0.51503322668528106476 0.072774833431763982783 -0.52509418031624877088 -0.19796564504777031113 0.25445654094000064172 -0.23659317871123891619 0.56980154273185101843 -0.36070997000546589639 0.21793152858510891901;-0.39133820722312656626 0.69287409724230486496 0.62892675133417219602 0.14161324128321434168 0.46904577578992484588 0.50811220839259418902 0.012559483402490266568 -0.38240871768134993003 -0.21119865910539939446 -0.47609975185048380997 0.68000287726701436064 -0.68990179579687338496 -0.13740806216536502471 -0.092989070533521581141 -0.089289850014807561895 0.18340732061071171599;0.8574041051574099459 0.32184875900848070041 -0.34836633102874525747 0.28711958174338308991 -0.34736864924879917726 -0.36075886648190497175 -0.73227149418683612492 0.41365192324195659834 0.54599911018225799619 -0.31149747822009637988 -0.20215302615446403833 -0.27023857489174019086 -0.27390211042644402317 0.42661403415052462362 -0.55530150472221539992 -0.15142785760016211349;0.13373521313422315204 0.10868061296747068278 0.17977716781344435515 0.11465989276486936166 -0.70080998106522429669 0.38933158183225774485 0.0069913229696797951282 0.7703177065118058664 -0.17840426652854413092 0.21688925343811008006 0.81078587488325148946 0.84548618584204360271 0.44774657395653372216 0.096553682317717562378 0.14151850242078600761 0.29645273617918294073;0.61307220598285805391 -0.58264104257028459521 -0.1047562021553821443 -0.34781233212404971678 -0.67203532979510605117 0.22564030276087737592 -0.45831933503110711126 0.8073072473266025284 -0.38621551919339025538 -0.10672906599838906383 -0.15259382219477016229 0.14089325890636528182 -0.24394028004155479672 -0.061057858617896684783 -0.74335273928270584332 -0.09144454979949816209;0.65954187680498488344 0.6559050249003762767 -0.51982929382517328865 -0.038502696759969631812 -0.5443996600281768572 0.52940527767255585179 -0.12786651787537484104 0.50049944545922098182 -0.26655639982428752655 -0.082191316182498308507 -0.41995147432844909252 0.5940678529463927493 0.17011495871001813818 -0.36204278561453340224 0.15252482597855379631 0.45763000211503990222;0.49592219932687570116 0.43368258484355121096 -0.34274480337310453404 0.54692284683732994566 0.48712598877400659081 0.2284891155405251173 -0.071762278248206273767 -0.072430907790062615259 0.40247215712371736673 -0.2165969657088217537 0.45249810947310914466 0.47064418888748327241 0.42731316154802551077 -0.47093525261705637686 -0.63647506140295673216 0.15928213325269896528;0.029198177993993688212 0.49074659522783453669 -0.38921614196737952529 0.49874754251356362422 0.70918569647798990196 -0.084754169676292664959 -0.41852900873253084946 -0.59829968238293140814 -0.14478160895007047282 0.52844181365755305002 0.064502201540222472986 0.36214755306634366372 -0.51214089019590880447 -0.58613064768111167169 0.48514417132095299934 -0.053373343786255793286;-0.56718176228551964169 0.36466273636028012639 0.68952783812028417554 0.7169233469234463918 -0.50516036828849519846 0.28198307943342193482 0.33856490564660890463 -0.75527723085299347527 -0.078034964087342229 0.31640964945760530203 -0.12256440854334998969 0.052885622678757016057 -0.48246132362785865144 0.59139903870442067646 -0.13185228777240209919 0.11689813561901604699;-0.40269317104475305102 -0.28894289401448880472 0.027930590328756832452 0.64533942194684801308 0.37406361289784217927 0.13230343517729015179 -0.3610684580172924818 -0.52638716787291039978 -0.28127119121189309014 -0.569032543519799483 0.16871042603172070606 0.55690802821672580336 0.66363531756263638428 -0.17565932344354967531 -0.57563022463107960114 0.25849261335459439159;-0.14674982500405353569 0.33346434186247569942 0.43196235038997304878 0.39294390795425310214 -0.61621837131364398665 0.02117799021834314982 0.28558020268055844815 0.43805931373794332329 0.088068381026991937599 -0.61473415841332035292 -0.34566177799755748445 -0.68570923305778175294 0.69999110874249659275 0.24098377071550644568 0.13983829857624610615 0.6081613535668216608;0.0077494331146530093246 -0.27829747434623369751 -0.43428987465783253086 -0.66988628283818740794 -0.59000000301762611787 0.33887396355948096183 -0.15037651494921203121 0.013108092652289127233 -0.45714884931008525903 -0.64123337040138039811 -0.36776085480134579342 0.29595894038799408499 -0.35320776921783303415 -0.53080470764663767458 0.20091294666071260466 0.63754983141293253279;0.64062120702051605914 0.17456991636526619782 -0.41285697821837047394 0.74651661652449274875 -0.47513689676583770183 -0.18759920594250573123 0.11772477895178976026 0.3330003714770369827 -0.31030470216781808057 0.63472328217108930914 -0.4396092868550416366 -0.60132743184468351316 -0.32612024504147679727 0.13253595836036746736 0.42650169801268195124 0.34665556801629809902;0.61667015884108677959 -0.29902805952398409106 0.50726534720023208624 -0.063676968390244351181 0.61096568897619873972 -0.54465320088520197128 0.51954909986509301145 -0.39963175969306879987 0.041742211832684887607 -0.18755316689792483897 0.10761330673705657435 -0.66700515740197463543 0.48334130189150747992 -0.56355198137059503427 0.34390083243335944907 -0.0076219565953752465431;0.64641541465769369879 0.024210368556014636582 0.022683970510928814363 0.013324923543853280788 0.11748162959271510331 -0.2444311648751879007 -0.3272463522122626145 -0.75615256945107811593 0.062687079456766020558 -0.17790711940758835441 0.61032478295032976945 -0.47144285459082213574 0.49221472174936270472 -0.43814027153791368363 0.44315729498457973046 -0.69782938969163899046;-0.30656782336444748926 0.43049188889049189166 0.77096990129633202748 -0.61228038578011168003 -0.82235082777035817259 0.35081128741073808186 -0.2887700011923755028 -0.50761868607128346476 -0.11629916036318561912 0.012033269298080545573 0.53106732150392654823 0.049050390476017641239 -0.14054435791787892041 -0.090967320751165106629 0.15393572032872498978 -0.51234527620338332632;-0.14904746611405816914 0.33994031542362418419 -0.45328718438599219231 0.39093819748199543085 0.521751617224238462 0.54653369187820155517 -0.49101844676654865518 0.1812604774749909109 0.56583699856235902814 -0.43282391466334324548 0.19920909803140901539 -0.67580131462231363138 -0.18747128221966527506 0.29732794052201388935 0.56807029293305799644 0.49213164137764325856;0.43479940543985723389 -0.082554172410333859222 0.54084533312704541341 0.27896982141082588003 0.50483371706917579136 -0.13883942746410893321 0.38098124599748584007 -0.54860072431838557971 0.4132581481220451991 -0.57053100646342858049 0.59658295385263393484 0.4211842072467382736 -0.24722825326086067532 0.51264189535542314946 0.27030753010639574363 0.48850578118568971364;0.050564606299064611405 -0.52180429187429755444 -0.1669278963182969644 0.09226350133936445097 0.046094769647554038883 -0.71867642453085134324 0.32600631579546190952 0.66886501427709033063 0.65257979218350037343 0.26127537148772927988 0.72500095167611400271 -0.058193797003409916679 -0.39798603288626405172 0.49617726401392553415 0.39859743856251905747 0.25407698359758379425;-0.053540339294174378593 -0.68898407890543067467 -0.066975046659853779141 0.34211691252578685374 -0.057202325289056735191 -0.65685584456305212697 0.57886813267462000621 0.70053463981408969907 0.44413421809910519356 -0.058204364592888441221 0.2623618059664808988 -0.48488013522049105974 0.68461368699139779626 -0.38395601191618705661 0.29591960319790971967 -0.041718428362911376406;-0.35417249043968385136 -0.67348865370852850631 -0.2758175764196297286 0.28315572612127370977 0.23242518718842364311 0.45714874830366714065 -0.42076541830004243749 -0.046757034184585682945 -0.040040508916254026472 -0.50352797205631927291 0.41913089441845269301 -0.41914673686360687244 -0.72687393364555852315 -0.32171400831253710306 0.24474285587539931774 0.76560548940852124478;0.15408625828590000184 0.44763920438836568572 -0.54834878142017029479 0.14594997018240635223 -0.34377747719004408955 0.47639061481292810374 0.0093402626096393132071 0.56053662999569253689 -0.23907570515920839593 -0.3362270665828382965 -0.19752837909924317317 -0.51688654680246048922 0.27740174819137913831 0.51960081370564403791 0.46647540187923020039 -0.52397510424720816768;-0.58803478466862579843 0.10842036458442824709 0.50402093704415562581 -0.75190479188981695913 0.36590656165247092968 0.3131880430277368399 0.0084966344575768126823 0.06247781716146547093 -0.5503836371529029492 0.30155735109672943128 0.31392293898223894155 -0.57071578203070671975 -0.10396040969444887703 -0.37402862331208430735 0.67220200025392962129 -0.27192915997451183596;0.49130020851094796663 0.16708593473085978087 -0.48329355205647761551 -0.012248046951817165295 0.48784313222432951207 0.58434476545486613297 -0.081986722835035469314 0.48912477540300502987 -0.32230689582570443141 0.33874109772918287176 -0.55012531347649551439 -0.039820814014402579339 -0.44289393587854541945 -0.45159628667584955641 -0.1386244216111196248 -0.61819425369438318896;0.42453384243907371642 -0.94129099895954471133 0.63773997356138989456 -0.16544172212123672838 -0.62933025228597372358 0.013024814236913104595 -0.34897844483126960746 -0.028529119696162417996 -0.12679317389981908937 0.081899073220922075089 -0.25835226278885908835 -0.057153281175634194911 -0.060804941458694972134 0.4841964868555289625 -0.7613439705402509361 0.19473128666058342473;0.59755364318518289224 -0.49457739166338787751 -0.17641951467287636524 0.41143499868072025416 0.30282799714399882829 0.049140286835493499074 0.5539739614193525119 -0.86627140238291133745 -0.054208308872962109037 0.035531157880680383498 -0.31180641987942331328 -0.32694710842577984211 0.43826575701205688906 -0.43180216780515567887 0.64533690502045570891 0.11689948250679774167;-0.010525782610492782215 -0.67539731538321134963 -0.12927740513975413683 -0.16089032323469520946 0.22277616770544506064 0.25945729479784762628 -0.19691899223494888083 -0.06514267736919221452 0.77627135632061539106 -0.14523912806439048806 -0.60583900719105421295 -0.10195456166353096539 0.75389544995729662613 -0.27466033279227353159 0.29812105767368979325 -0.8042116922840880644;0.63572507361294405825 -0.37103047144140277602 0.09816128001258761504 0.12095743530638704277 0.22396269844525218407 0.60216920455145350743 0.6107668391526820395 -0.19302188410881612746 0.58959925477354035994 0.058618254945586437121 0.64110644821983597819 -0.19609038160897945824 0.077703581601648336052 -0.64385172901531884104 -0.42060688201894264049 0.13386559462583441649];

% Layer 2
b2 = 0.72786417475300002611;
LW2_1 = [-0.47477046510109172095 -1.0204698880669123007 0.69165628654327959701 -0.51684938392602175483 0.3653549864781381884 0.8266932449207469169 0.088442402306402267964 -0.69158722406359685042 -0.12399699349564381745 -0.082731922839334309794 0.58111480124730297003 0.71657889582495060132 -0.31677190822679257565 0.7348610346792437964 -0.71921977781057622181 -0.34449281120100383458 0.31950218723811985022 0.041729907578671843194 -0.23993582958359338519 -0.39410879623095995683 -0.47309549038721848691 0.044810859016312792891 0.4538669731215720371 0.059918646563158428631 -0.11499365955354395874 -0.46986273578995263467 -0.54638579754210814254 1.0816834018479712931 0.60155725436929274874 -0.1811502677154953056 0.24994500755005411019 0.33366347753107516994 0.18034111981054579132];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.1;
y1_step1.xoffset = 50;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
